alter session set current_schema = mt_toy;
SET heading OFF

SELECT T.TOY_ID, T.TOY_NAME
FROM TOY_RENTAL TR INNER JOIN TOY T
ON TR.TOY_ID = T.TOY_ID
WHERE TO_CHAR(TR.RENTAL_END_DATE,'DD-MM-YY') = '31-07-20'
GROUP BY T.TOY_ID, T.TOY_NAME
HAVING COUNT(TR.TOY_ID) = ( SELECT QUANTITY FROM TOY TT WHERE TT.TOY_ID = T.TOY_ID )
ORDER BY COUNT(T.TOY_ID) DESC ;